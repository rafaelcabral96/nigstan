"0","models.compare.continuous <- function(loc, sigma=1, nu=1, mu=0, prac.range=max(loc)/2, seed=1, noise = 'GAL'){"
"0","  sigma.star <- sigma/sqrt(1+nu*mu^2)"
"0"," "
"0","  SPDE <- SPDE.matrix(loc, kappa = sqrt(3/2*8)/prac.range)"
"0","  h    <- diag(SPDE$C0)"
"0","  n    <- length(loc)"
"0","  "
"0","  #sample V"
"0","  set.seed(seed)"
"0","  "
"0","  if(noise=='GAL'){"
"0","    V = rgamma(n,h/nu,1/nu)"
"0","  }"
"0","  else if (noise=='NIG'){"
"0","    V = rinvGauss(n,h,h^2/nu)"
"0","  }"
"0",""
"0","  #sample lambda"
"0","  Z = rnorm(n)"
"0","  L = sigma.star*(-mu*h+mu*V+sqrt(V)*Z) "
"0","  "
"0","  #sample RW1"
"0","  Dp = ginv(as.matrix(RW1.matrix(n)))"
"0","  RW1 = Dp%*%L[2:n]"
"0",""
"0","  #sample AR1"
"0","  #Dp = solve(OU.matrix(loc,kappa = -log(0.5))$K)"
"0","  #when kappa goes to 0 (practicall correlation range to infinity)"
"0","  Dp = solve(OU.matrix2(loc,kappa = sqrt(1/2*8)/prac.range))"
"0","  OU = Dp%*%L[1:n]"
"0",""
"0","  "
"0","  #sample RW2"
"0","  Dp = ginv(as.matrix(-SPDE$G))"
"0","  RW2 = Dp%*%L[1:n]"
"0","  "
"0","  #sample SPDE (practical correlation range = 50)"
"0","  Dp = solve(SPDE$K)"
"0","  Matern = Dp%*%L[1:n]"
"0","  "
"0","  plot.data <- as.data.frame(list(t = loc, Noise = L, RW1 = c(RW1), OU = OU[,1], RW2 = c(RW2), Matern = Matern[,1]))"
"0","  plot.data <- melt(plot.data, id.vars=""t"")"
"0","  "
"0","  mytitle = paste(""Simulation parameters: \u03C3 ="",sigma, "";  η ="", nu, ""; μ ="", mu)"
"0","  subtitle = paste(noise, 'noise')"
"0","  "
"0","  ggplot(data = plot.data, aes(t, value)) +"
"0","  geom_line(color = ""black"", size = 0.5) +"
"0","  #geom_point(color = ""black"", size = 0.1) + "
"0","  labs(title = mytitle,"
"0","       subtitle = subtitle,"
"0","       y = ""Value"", x = ""location"") + "
"0","  facet_grid(variable ~ . , scales='free')  + theme(aspect.ratio = 1/5)"
"0"," "
"0","}"
"0",""
"0",""
"0",""
